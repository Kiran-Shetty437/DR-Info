<!DOCTYPE html>
<html>
<head>
    <title>Hospital Doctors Directory</title>
    <style>
        body { font-family: Arial; margin: 0; padding: 20px; background: #f5f5f5; }
        .navbar { background: #007bff; color: white; padding: 15px; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .navbar h2 { margin: 0; }
        .navbar a { color: white; text-decoration: none; margin-right: 15px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .card { background: white; padding: 20px; border-radius: 5px; margin-bottom: 20px; box-shadow: 0 0 5px rgba(0,0,0,0.1); }
        .doctor-list-container { display: flex; align-items: center; gap: 10px; margin-top: 15px; }
        .scroll-btn { background: #007bff; color: white; border: none; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; font-size: 18px; flex-shrink: 0; }
        .scroll-btn:hover { background: #0056b3; }
        .doctor-list { display: flex; gap: 15px; flex-wrap: wrap; padding: 5px 0; }
        .doctor-card { background: #f9f9f9; padding: 15px; border-radius: 5px; border: 1px solid #ddd; min-width: 250px; flex-shrink: 0; cursor: pointer; transition: transform 0.2s; }
        .doctor-card:hover { transform: translateY(-5px); }
        .doctor-card img { width: 100%; height: 150px; object-fit: cover; border-radius: 5px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover:not(:disabled) { background: #0056b3; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        /* NEW: Profile Link Button */
        .profile-link { 
            background: #17a2b8; 
            color: white; 
            padding: 8px 15px; 
            text-decoration: none; 
            border-radius: 5px; 
            font-size: 14px; 
            display: inline-block; 
            margin-top: 10px; 
        }
        .profile-link:hover { background: #138496; }
    </style>
</head>
<body>
    <div class="navbar">
        <h2>üè• Hospital Doctors Directory</h2>
        <div><a href="/">Home</a> <a href="/login"><button>Login</button></a></div>
    </div>

    <div class="container">
        <div style="margin-bottom: 20px; text-align: center;">
            <form method="get" action="/">
                <input type="text" name="search" placeholder="Search hospital, doctor, or specialization..." value="{{ search_query }}" style="padding:10px; width:60%; max-width:500px; border-radius:5px; border:1px solid #ccc;">
                <button type="submit">Search</button>
                <a href="/" style="margin-left:10px; padding:10px 20px; background:#6c757d; color:white; border-radius:5px; text-decoration:none;">Clear</a>
            </form>
        </div>

        {% for item in hospitals_with_doctors %}
        <div class="card">
            <h2 style="margin-top: 0; color: #007bff;">üè• {{ item.hospital[1]|upper }}</h2>
            <p style="color: #666; margin: 10px 0;"><strong>Location:</strong> {{ item.hospital[2] }}</p>
            {% if item.hospital[3] %}
            <img src="/static/uploads/{{ item.hospital[3] }}" alt="Hospital" style="width: 100%; height: auto; border-radius: 5px; margin-bottom: 15px; max-height: 300px; object-fit: cover;">
            {% endif %}
            <h3 style="margin-top: 20px;">üë®‚Äç‚öïÔ∏è Our Doctors</h3>
            <div class="doctor-list">
                {% for doctor in item.doctors %}
                    <div class="doctor-card">
                        {% if doctor[8] %}
                        <img src="/static/uploads/{{ doctor[8] }}" alt="Doctor">
                        {% else %}
                        <div style="width: 100%; height: 150px; background: #ddd; border-radius: 5px; display: flex; align-items: center; justify-content: center; color: #999;">No Image</div>
                        {% endif %}
                        <h4>{{ doctor[2] }}</h4>
                        <div class="doctor-info">
                            <p><strong>Specialization:</strong> {{ doctor[3] }}</p>
                            <p><strong>Education:</strong> {{ doctor[4] }}</p>
                        </div>
                        <!-- NEW: Profile Link -->
                        <a href="/book_appointment/{{ doctor[0] }}" class="profile-link" style="margin-top: 10px; display: inline-block;">üìÖ Book Appointment</a>
                        <a href="/doctor_profile/{{ doctor[0] }}" class="profile-link" style="margin-top: 10px; display: inline-block;">üëÅÔ∏è View Profile</a>
                    </div>
                    {% endfor %}
                </div>
        </div>
        {% endfor %}

        {% if not hospitals_with_doctors %}
        <div class="card">
            <p style="text-align: center; color: #999;">No hospitals or doctors found.</p>
        </div>
        {% endif %}
    </div>
</body>
</html>